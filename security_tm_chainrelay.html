<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Threat model ChainRelay - The Integritee Book</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div id="sidebar-scrollbox" class="sidebar-scrollbox">
                <ol class="chapter"><li class="expanded affix "><a href="introduction.html">Introduction</a></li><li class="expanded "><a href="trusted_execution.html"><strong aria-hidden="true">1.</strong> What is Trusted Execution?</a></li><li><ol class="section"><li class="expanded "><a href="remote_attestation.html"><strong aria-hidden="true">1.1.</strong> Remote Attestation</a></li></ol></li><li class="expanded "><a href="what_for.html"><strong aria-hidden="true">2.</strong> What is Integritee Good For?</a></li><li><ol class="section"><li class="expanded "><a href="privacy.html"><strong aria-hidden="true">2.1.</strong> Privacy</a></li><li class="expanded "><a href="scalability.html"><strong aria-hidden="true">2.2.</strong> Scalability</a></li><li class="expanded "><a href="interoperability.html"><strong aria-hidden="true">2.3.</strong> Interoperability</a></li><li><ol class="section"><li class="expanded "><a href="interoperability-bridges.html"><strong aria-hidden="true">2.3.1.</strong> Bridges</a></li></ol></li><li class="expanded "><a href="use_case_cdn.html"><strong aria-hidden="true">2.4.</strong> CDN</a></li></ol></li><li class="expanded "><a href="design.html"><strong aria-hidden="true">3.</strong> Design</a></li><li><ol class="section"><li class="expanded "><a href="sharding.html"><strong aria-hidden="true">3.1.</strong> Sharding</a></li><li class="expanded "><a href="token_shielding.html"><strong aria-hidden="true">3.2.</strong> Token Shielding</a></li><li class="expanded "><a href="security.html"><strong aria-hidden="true">3.3.</strong> Security</a></li><li><ol class="section"><li class="expanded "><a href="security_intel_sgx.html"><strong aria-hidden="true">3.3.1.</strong> Intel SGX</a></li><li class="expanded "><a href="security_tm_chainrelay.html" class="active"><strong aria-hidden="true">3.3.2.</strong> Threat model ChainRelay</a></li></ol></li><li class="expanded "><a href="benchmarks.html"><strong aria-hidden="true">3.4.</strong> Benchmarks</a></li><li class="expanded "><a href="hw_diversification.html"><strong aria-hidden="true">3.5.</strong> HW Diversification</a></li><li><ol class="section"><li class="expanded "><a href="hw_ra_by_distributor.html"><strong aria-hidden="true">3.5.1.</strong> Distributor-Level Remote Attestation</a></li></ol></li><li class="expanded "><a href="sidechain.html"><strong aria-hidden="true">3.6.</strong> Sidechain</a></li><li><ol class="section"><li class="expanded "><a href="sidechain_system_networking.html"><strong aria-hidden="true">3.6.1.</strong> System and Networking</a></li></ol></li></ol></li><li class="expanded "><a href="howto.html"><strong aria-hidden="true">4.</strong> Howto</a></li><li><ol class="section"><li class="expanded "><a href="howto_node.html"><strong aria-hidden="true">4.1.</strong> How To Run a Node</a></li><li class="expanded "><a href="howto_worker.html"><strong aria-hidden="true">4.2.</strong> How To Run a Worker</a></li><li class="expanded "><a href="howto_private_tx.html"><strong aria-hidden="true">4.3.</strong> How To Perform a Private Transaction</a></li><li class="expanded "><a href="howto_direct_tx.html"><strong aria-hidden="true">4.4.</strong> How To Perform Direct Invocation</a></li><li class="expanded "><a href="howto_sidechain_multivalidateer.html"><strong aria-hidden="true">4.5.</strong> How To Run a sidechain multi-validateer setup</a></li><li class="expanded "><a href="howto_access_onchain_storage.html"><strong aria-hidden="true">4.6.</strong> How To Access On-Chain Storage Trustlessly</a></li><li class="expanded "><a href="howto_stf.html"><strong aria-hidden="true">4.7.</strong> How To Build Your Own Trusted STF</a></li></ol></li><li class="expanded "><a href="roadmap.html"><strong aria-hidden="true">5.</strong> Roadmap</a></li><li class="expanded "><a href="glossary.html"><strong aria-hidden="true">6.</strong> Glossary</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">The Integritee Book</h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#threat-model-of-chainrelay" id="threat-model-of-chainrelay">Threat model of ChainRelay</a></h1>
<h2><a class="header" href="#introduction" id="introduction">Introduction</a></h2>
<p>A security threat model for the ChainRelay of Integritee.</p>
<p>The following points will be analysed:</p>
<ul>
<li><strong>S</strong>poofing</li>
<li><strong>T</strong>ampering</li>
<li><strong>R</strong>epudiation</li>
<li><strong>I</strong>nformation disclosure</li>
<li><strong>D</strong>enial of service</li>
<li><strong>E</strong>levation of privileges</li>
</ul>
<h2><a class="header" href="#system-overview" id="system-overview">System overview</a></h2>
<p><img src="fig/integritee-chainRelay-dataflow.svg" alt="Diagram" /></p>
<h2><a class="header" href="#actors" id="actors">Actors</a></h2>
<h3><a class="header" href="#user" id="user">User</a></h3>
<p>User of the system that holds tokens either on-chain or in an incognito account.</p>
<ul>
<li>They use the integritee-cli</li>
<li>They can send extrinsics/transactions to the node that will then be processed by the enclave</li>
<li>They can query their own enclave state, the enclave public key and the mutual-remote-attestation port directly from a worker over WebSocket</li>
<li>They hold their key pairs (for on-chain and incognito accounts)</li>
</ul>
<h3><a class="header" href="#worker-operator" id="worker-operator">Worker operator</a></h3>
<p>Operates the worker and the enclave.</p>
<ul>
<li>They use the integritee-service</li>
<li>They have full access to the system (HW, OS and services)</li>
</ul>
<h3><a class="header" href="#vendor" id="vendor">Vendor</a></h3>
<p>Releases Integritee software</p>
<ul>
<li>They distribute SW binaries</li>
<li>They can sign enclaves with MRSIGNER</li>
</ul>
<p>There is no specific vendor in Integritee as it is open source code that can be deterministically built by anyone to reach an identical MRENCLAVE for the enclave. Therefore, each operator is also a vendor!</p>
<p>Because of this Integritee may not use MRSIGNER policy but MRENCLAVE for SGX sealed storage (known issue https://github.com/integritee-network/worker/issues/88)! This means that sealed storage can only be accessed by the very same untampered version of the enclave running on the same HW platform.</p>
<p>Software updates are not yet supported: https://github.com/integritee-network/worker/issues/85</p>
<h2><a class="header" href="#analysis" id="analysis">Analysis</a></h2>
<table><thead><tr><th><strong>Attack Category</strong></th><th><strong>Actor</strong></th><th><strong>Description</strong></th><th><strong>Mitigation</strong></th><th><strong>Assessment</strong></th></tr></thead><tbody>
<tr><td>Impersonation</td><td>User</td><td>Get access to private keys of other users.</td><td>Protection of keys and key stores with passwords.<br/>WARNING: This is the responsibility of the developer building the client. Our example client does not include any mitigations.</td><td>delegated</td></tr>
<tr><td>Eclipsing</td><td>Operator or ISP</td><td>Expose the worker to a different (malicious) node</td><td>Rely on finality and read proofs with Light-Client</td><td>OK since M6</td></tr>
<tr><td>Spoofing</td><td>Operator</td><td>Modify the enclave to perform malicious operations</td><td>Remote Attestation, TrustedCall signature payload includes MRENCLAVE</td><td>OK</td></tr>
<tr><td>Tampering</td><td>User</td><td>Replay TrustedCalls (i.e. repeat transactions of funds until account depleted)</td><td>Use of nonce in TrustedCall</td><td><a href="https://github.com/integritee-network/worker/issues/89">known issue</a></td></tr>
<tr><td>Tampering</td><td>Operator</td><td>Tamper with the block header store of the Light-Client (roll back or modify)</td><td>Block header store is encrypted as SGX sealed storage<br/>Sync with chain upon startup<br/>Verify linked-hash-chain of block headers</td><td>OK</td></tr>
<tr><td>Tampering</td><td>Operator</td><td>Tamper with the state of the enclave</td><td>State is encrypted with the state-encryption-key, the private key stored in SGX sealed storage with MRENCLAVE policy</td><td><a href="https://github.com/integritee-network/worker/issues/88">known issue</a></td></tr>
<tr><td>Tampering</td><td>Operator</td><td>Block confirmations from worker to node</td><td>Redundancy of workers</td><td>OK</td></tr>
<tr><td>Tampering</td><td>Operator</td><td>Modify worker-api response to TrustedGetter</td><td>Enclave signs responses</td><td><a href="https://github.com/integritee-network/worker/issues/91">known issue</a></td></tr>
<tr><td>Repudiation</td><td>Operator</td><td>Deny WorkerApi access to certain users selectively</td><td>Redundancy of workers</td><td>OK</td></tr>
<tr><td>Information disclosure</td><td>Operator</td><td>Get information about contents of TrustedCalls</td><td>TrustedCalls are encrypted with public shielding key of the enclave (whose private key is stored in SGX sealed storage with MRENCLAVE policy)</td><td><a href="https://github.com/integritee-network/worker/issues/88">known issue</a></td></tr>
<tr><td>Information disclosure</td><td>Operator</td><td>Get information about contents of TrustedGetters responses</td><td>Encrypt responses<br/>wss:// to WorkerApi into enclave</td><td><a href="https://github.com/integritee-network/worker/issues/91">known issue</a></td></tr>
<tr><td>Information disclosure</td><td>Operator</td><td>Get meta information about TrustedCalls</td><td>Indirect invocation: need to use public account to proxy the TrustedCall through blockchain. Use fresh unlinkable accounts for each TrustedCall.<br/>Direct invocation: limited access to meta information (network layer only)</td><td>(delegated)<br/><a href="https://github.com/integritee-network/worker/issues/88">known issue</a></td></tr>
<tr><td>Information disclosure</td><td>Operator</td><td>Know which incognito account belongs to whom</td><td>SGX confidentiality guarantees, encrypted TrustedCall and TrustedGetter with enclave shielding key</td><td><a href="https://github.com/integritee-network/worker/issues/88">known issue</a></td></tr>
<tr><td>Information disclosure</td><td>Operator</td><td>Leak state information</td><td>SGX confidentiality guarantees, encrypted state with state-encryption-key<br/>MRENCLAVE policy for SGX sealed storage</td><td><a href="https://github.com/integritee-network/worker/issues/88">known issue</a></td></tr>
<tr><td>Information disclosure</td><td>User</td><td>Get information about other accounts and users in the enclave</td><td>Authentication of TrustedGetter.<br/>User can only query own state</td><td>OK</td></tr>
<tr><td>Denial of service</td><td>Operator</td><td>Limit the resources of the worker or the enclave to slow down the system</td><td>Redundancy of workers</td><td>OK</td></tr>
<tr><td>Denial of service</td><td>User</td><td>Send invalid transactions to crash either the worker or the enclave</td><td>Ensure enclave code doesn't panic</td><td>OK to the best of our knowledge</td></tr>
<tr><td>Denial of service</td><td>User</td><td>Overload the system with spam (TrustedGetters or TrustedCalls)</td><td>TrustedCalls: cost of tx fees (indirect invocation), block size limit<br/>TrustedGetter: load balancing as needed (scale number of workers horizontally), standard DDoS mitigation</td><td>delegated</td></tr>
</tbody></table>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="security_intel_sgx.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="benchmarks.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="security_intel_sgx.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="benchmarks.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
